from Queue import Queue

import threading, socket

dominio = "dominio.com"

lock = threading.Lock()

def forca_bruta():
    while not q.empty():
        DNS = q.get() + "." + dominio
    
    try:

        IP = socket.gethostbyname(DNS)

        lock.acquire()

        print(DNS + ":\t" + IP)

    except socket.gaierror:
        pass
    else:
        lock.release()
    q.task_done()

q = Queue()

for i in range(20):
    t = threading.Thread(target=forca_bruta)
    t.daemon = True
    t.start()

with open("lista.txt") as lista:
    nome = lista.readline().strip("\n")
    if not nome:
        break

    q.put(nome)
q.join()
print ("\nMapeamento completo")

